<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >
<mapper namespace="cn.south.toast.base.dao.exp.ResourceExpMapper">
	<resultMap id="BaseResultMap" type="cn.south.toast.base.module.Resource" >
		<!--
          WARNING - @mbggenerated
          This element is automatically generated by MyBatis Generator, do not modify.
        -->
		<id column="_Resource_id" property="id" jdbcType="VARCHAR" />
		<result column="_Resource_parent_id" property="parentId" jdbcType="VARCHAR" />
		<result column="_Resource_number" property="number" jdbcType="INTEGER" />
		<result column="_Resource_long_number" property="longNumber" jdbcType="VARCHAR" />
		<result column="_Resource_name" property="name" jdbcType="VARCHAR" />
		<result column="_Resource_url" property="url" jdbcType="VARCHAR" />
		<result column="_Resource_description" property="description" jdbcType="VARCHAR" />
		<result column="_Resource_type" property="type" jdbcType="INTEGER" />
		<result column="_Resource_show_menu" property="showMenu" jdbcType="INTEGER" />
		<result column="_Resource_delete_flag" property="deleteFlag" jdbcType="INTEGER" />
		<result column="_Resource_create_time" property="createTime" jdbcType="TIMESTAMP" />
		<result column="_Resource_update_time" property="updateTime" jdbcType="TIMESTAMP" />
		<result column="_Resource_update_by" property="updateBy" jdbcType="VARCHAR" />
		<result column="_Resource_create_by" property="createBy" jdbcType="VARCHAR" />
		<result column="_Resource_has_function_children" property="hasFunctionChildren" jdbcType="BIT" />
	</resultMap>
	<select id="listResourceByUserId" parameterType="java.lang.String" resultType="java.lang.String">
		SELECT 
		DISTINCT
		CONCAT(resource.url,'**')
		FROM auth_resource resource
		JOIN auth_role_resouce_rel rrr ON rrr.resouce_id = resource.id
		JOIN auth_user_role_rel urr ON urr.role_id = rrr.role_id
		WHERE resource.delete_flag = 0
		AND urr.user_id = #{userId}
	</select>
	
		<select id="listMenuResource" parameterType="java.lang.String" resultType="cn.south.toast.base.dto.MenuResourceOutDTO">
		SELECT 
		DISTINCT
		resource.id
		,resource.parent_id
		,resource.name
		,resource.url
		FROM auth_resource resource
		JOIN auth_role_resouce_rel rrr ON rrr.resouce_id = resource.id
		JOIN auth_user_role_rel urr ON urr.role_id = rrr.role_id
		WHERE resource.delete_flag = 0
		AND resource.type = 0
		AND resource.show_menu = 0
		AND urr.user_id = #{userId}
		ORDER BY resource.number
	</select>
	
		<select id="listButtonResource" parameterType="java.lang.String" resultType="String">
		SELECT 
		DISTINCT
		resource.url
		FROM auth_resource resource
		JOIN auth_role_resouce_rel rrr ON rrr.resouce_id = resource.id
		JOIN auth_user_role_rel urr ON urr.role_id = rrr.role_id
		WHERE resource.delete_flag = 0
		AND resource.type = 1
		AND urr.user_id = #{userId}
		ORDER BY resource.long_number
	</select>
	
</mapper>